databaseChangeLog:
- changeSet:
    ignore: false
    id: drop-primary
    author: stephenatwell
    changes:
    -  dropPrimaryKey:
        constraintName: PK__Warehous__3214EC27E991EA03
        dropIndex: true
        tableName:  Warehouses
    - dropIndex:
        indexName: PK__Inventor__3214EC27FD87BA6A
        tableName: Inventory
    rollback: 
    -  addPrimaryKey:
        constraintName: PK__Warehous__3214EC27E991EA03
        columnNames: ID
        tableName:  Warehouses  
    - createIndex:
        indexName: PK__Inventor__3214EC27FD87BA6A
        tableName: Inventory
        clustered: true
        unique: true
        associatedWith: primaryKey
- changeSet:
    id: create-new-keys
    ignore: false
    author: stephenatwell
    changes:
    - createIndex:
            tableName: Inventory
            unique: false
            indexName: idx_name_warehousename
            clustered: false
            columns:
              - column:
                  name: WarehouseName
              - column:
                  name: Name
    -  addNotNullConstraint:
        columnName:  Location
        columnDataType: nvarchar(50)
        constraintName:  location_non_nullable
        defaultNullValue:  newId()
        tableName:  Warehouses
        validate:  true
    - addPrimaryKey:
        clustered:  true
        columnNames:  Location
        constraintName:  pk_location
        tableName:  Warehouses
        validate:  true
    - addForeignKeyConstraint:
            basetableName: Inventory
            baseColumnNames: WarehouseName
            constraintName:  fk_WarehouseName
            referencedTableName: Warehouses
            referencedColumnNames: Location
            validate:  true
    - createIndex:
            tableName: Inventory
            unique: false
            indexName: idx_warehousename
            clustered: false
            columns:
              - column:
                  name: WarehouseName
    - createIndex:
            tableName: Inventory
            unique: false
            indexName: idx_quantity
            clustered: false
            columns:
              - column:
                  name: Quantity
    - createIndex:
            tableName: Inventory
            unique: false
            indexName: idx_quantity_name
            clustered: false
            columns:
              - column:
                  name: Name
              - column:
                  name: Quantity
    - createIndex:
            tableName: Inventory
            unique: false
            indexName: idx_warehousename_quantity_name
            clustered: true
            unique: true
            associatedWith: primaryKey
            columns:
              - column:
                  name: WarehouseName
              - column:
                  name: Name
              - column:
                  name: Quantity

